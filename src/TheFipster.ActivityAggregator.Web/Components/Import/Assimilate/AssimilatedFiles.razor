@using TheFipster.ActivityAggregator.Domain.Tools

@if (!string.IsNullOrWhiteSpace(Hash))
{
    <MudCard Class="flex-1">
        <MudCardHeader>
            <CardHeaderContent>
                <MudText Typo="Typo.h6">Files</MudText>
            </CardHeaderContent>
        </MudCardHeader>
        <MudCardContent Class="d-flex align-center">
            <MudTable Loading="@isLoading" Items="indexes" Elevation="0" Style="width: 100%">
                <HeaderContent>
                    <MudTh>Index time</MudTh>
                    <MudTh>Date range</MudTh>
                    <MudTh>Source</MudTh>
                    <MudTh>Count</MudTh>
                    <MudTh>Last Action</MudTh>
                </HeaderContent>
                <RowTemplate>
                    <MudTd DataLabel="Index time">@context.IndexedAt.ToString(DateHelper.UiSecondFormat)</MudTd>
                    <MudTd DataLabel="Date range">
                        @if (context.Dates.Count == 0)
                        {
                            <MudText Typo="Typo.body1">---</MudText>
                        }
                        else if (context.Dates.Count == 1)
                        {
                             <MudText Typo="Typo.body1">@context.Dates.First().ToString(DateHelper.UiDayFormat)</MudText>
                        }
                        else
                        {
                            <MudText Typo="Typo.body1">@context.Dates.Min().ToString(DateHelper.UiDayFormat) - @context.Dates.Max().ToString(DateHelper.UiDayFormat) ( @context.Dates.Count days )</MudText>
                        }
                    </MudTd>
                    <MudTd DataLabel="Source">@context.Source</MudTd>
                    <MudTd DataLabel="Count">@context.Count</MudTd>
                    <MudTd DataLabel="Last Action">
                        @if (context.Actions.Any())
                        {
                            <MudText
                                Typo="Typo.body1">@context.Actions.OrderByDescending(x => x.Key).First().Value</MudText>
                        }
                    </MudTd>
                </RowTemplate>
                <PagerContent>
                    <MudTablePager PageSizeOptions="new[] { 15 }"
                                   HideRowsPerPage="true"/>
                </PagerContent>
            </MudTable>
        </MudCardContent>
    </MudCard>
}