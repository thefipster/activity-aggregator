@using TheFipster.ActivityAggregator.Domain.Tools
<MudCard Class="flex-1">
    <MudCardHeader>
        <CardHeaderContent>
            <MudText Typo="Typo.h6">Zips</MudText>
        </CardHeaderContent>
    </MudCardHeader>
    <MudCardContent Class="d-flex align-center">
        <MudTable Context="item" Loading="@IsLoading" Items="@Zips.OrderByDescending(x => x.IndexedAt)" Elevation="0" Style="width: 100%">
            <HeaderContent>
                <MudTh>
                    <MudText Typo="Typo.subtitle2">Upload date</MudText>
                </MudTh>
                <MudTh>
                    <MudText Typo="Typo.subtitle2">File</MudText>
                </MudTh>
                <MudTh>
                    <MudText Typo="Typo.subtitle2">Zip size</MudText>
                </MudTh>
                <MudTh>
                    <MudText Typo="Typo.subtitle2">File count</MudText>
                </MudTh>
                <MudTh>
                    <MudText Typo="Typo.subtitle2">Total File size</MudText>
                </MudTh>
            </HeaderContent>
            <RowTemplate>
                <MudTd DataLabel="Upload date">
                    <MudText Typo="Typo.body1">@item.IndexedAt.ToString(DateHelper.UiMinuteFormat)</MudText>
                </MudTd>
                <MudTd DataLabel="File">
                    <MudText Typo="Typo.body1">@(new FileInfo(item.ZipPath).Name)</MudText>
                    @if (item.AlternateFiles.Any())
                    {
                        <MudTooltip Placement="Placement.Top" Arrow="true">
                            <ChildContent>
                                @(item.AlternateFiles.Count > 1 ? $"({item.AlternateFiles.Count - 1} more)" : string.Empty)
                            </ChildContent>
                            <TooltipContent>
                                <MudText Typo="Typo.subtitle2">All referenced files</MudText>
                                @foreach (var file in item.AlternateFiles)
                                {
                                    <MudText Typo="Typo.body2">@file</MudText>
                                }
                            </TooltipContent>
                        </MudTooltip>
                    }
                </MudTd>
                <MudTd DataLabel="Zip size">
                    <FipFileSize Typo="Typo.body1" Size="@item.PackedSize"></FipFileSize>
                </MudTd>
                <MudTd DataLabel="File count">
                    <MudText Typo="Typo.body1">
                        @item.FileCount
                    </MudText>
                </MudTd>
                <MudTd DataLabel="File size">
                    <FipFileSize Typo="Typo.body1" Size="@item.UnpackedSize"></FipFileSize>
                </MudTd>
            </RowTemplate>
            <PagerContent>
                <MudTablePager PageSizeOptions="new[] { 50 }"
                               HideRowsPerPage="true"/>
            </PagerContent>
        </MudTable>
    </MudCardContent>
</MudCard>