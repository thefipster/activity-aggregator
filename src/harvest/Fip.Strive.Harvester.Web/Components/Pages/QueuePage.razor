@page "/queue"
@using Fip.Strive.Core.Domain.Schemas.Queue.Models

<Headline Text="Queue" />

<MudGrid>
    <MudItem xs="3" md="6" sm="12">
        <MudTable T="JobDetails" Context="job" Dense="true" Hover="true" ServerData="@OnUpcommingRequested">
            <ToolBarContent>
                <MudText Typo="Typo.h2">Available Jobs</MudText>
            </ToolBarContent>
            <HeaderContent>
                <MudTh>Signalled</MudTh>
                <MudTh>Id</MudTh>
                <MudTh>Type</MudTh>
                <MudTh>Status</MudTh>
            </HeaderContent>
            <ColGroup>
                <col Style="width: 200px;"/>
                <col />
                <col Style="width: 150px;"/>
                <col Style="width: 150px;"/>
            </ColGroup>
            <RowTemplate>
                <MudTd DataLabel="Signalled">@job.SignalledAt</MudTd>
                <MudTd DataLabel="Id">@job.Id</MudTd>
                <MudTd DataLabel="Type">@job.Type</MudTd>
                <MudTd DataLabel="Status">@job.Status</MudTd>
            </RowTemplate>
            <NoRecordsContent>
                <MudText>No matching records found</MudText>
            </NoRecordsContent>
            <PagerContent>
                <MudTablePager/>
            </PagerContent>
        </MudTable>
    </MudItem>
    <MudItem xs="3" md="6" sm="12">
        <MudTable T="JobDetails" Context="job" Dense="true" Hover="true" ServerData="@OnRunningRequested">
            <ToolBarContent>
                <MudText Typo="Typo.h2">Running Jobs</MudText>
            </ToolBarContent>
            <HeaderContent>
                <MudTh>Signalled</MudTh>
                <MudTh>Id</MudTh>
                <MudTh>Type</MudTh>
            </HeaderContent>
            <ColGroup>
                <col Style="width: 200px;"/>
                <col />
                <col Style="width: 300px;"/>
            </ColGroup>
            <RowTemplate>
                <MudTd DataLabel="Signalled">@job.SignalledAt</MudTd>
                <MudTd DataLabel="Id">@job.Id</MudTd>
                <MudTd DataLabel="Type">@job.Type</MudTd>
            </RowTemplate>
            <NoRecordsContent>
                <MudText>No matching records found</MudText>
            </NoRecordsContent>
            <PagerContent>
                <MudTablePager/>
            </PagerContent>
        </MudTable>
    </MudItem>
    <MudItem xs="3" md="6" sm="12">
        <MudTable T="JobDetails" Context="job" Dense="true" Hover="true" ServerData="@OnSucceededRequested">
            <ToolBarContent>
                <MudText Typo="Typo.h2">Succeeded Jobs</MudText>
            </ToolBarContent>
            <HeaderContent>
                <MudTh>Signalled</MudTh>
                <MudTh>Id</MudTh>
                <MudTh>Type</MudTh>
            </HeaderContent>
            <ColGroup>
                <col Style="width: 200px;"/>
                <col />
                <col Style="width: 300px;"/>
            </ColGroup>
            <RowTemplate>
                <MudTd DataLabel="Signalled">@job.SignalledAt</MudTd>
                <MudTd DataLabel="Id">@job.Id</MudTd>
                <MudTd DataLabel="Type">@job.Type</MudTd>
            </RowTemplate>
            <NoRecordsContent>
                <MudText>No matching records found</MudText>
            </NoRecordsContent>
            <PagerContent>
                <MudTablePager/>
            </PagerContent>
        </MudTable>
    </MudItem>
    <MudItem xs="3" md="6" sm="12">
        <MudTable T="JobDetails" Context="job" Dense="true" Hover="true" OnRowClick="@OnErrorRowClicked" ServerData="@OnFailedRequested">
            <ToolBarContent>
                <MudText Typo="Typo.h2">Failed Jobs</MudText>
            </ToolBarContent>
            <HeaderContent>
                <MudTh>Signalled</MudTh>
                <MudTh>Id</MudTh>
                <MudTh>Type</MudTh>
            </HeaderContent>
            <ColGroup>
                <col Style="width: 200px;"/>
                <col />
                <col Style="width: 300px;"/>
            </ColGroup>
            <RowTemplate>
                <MudTd DataLabel="Signalled">@job.SignalledAt</MudTd>
                <MudTd DataLabel="Id">@job.Id</MudTd>
                <MudTd DataLabel="Type">@job.Type</MudTd>
            </RowTemplate>
            <NoRecordsContent>
                <MudText>No matching records found</MudText>
            </NoRecordsContent>
            <PagerContent>
                <MudTablePager/>
            </PagerContent>
        </MudTable>
    </MudItem>
</MudGrid>

<MudDialog @bind-Visible="_dialogVisible" Options="_dialogOptions">
    <TitleContent>
        <MudText Typo="Typo.h6">Error Details</MudText>
    </TitleContent>
    <DialogContent>
        <MudText Typo="Typo.button" Inline="false">Stack Trace</MudText>
        <MudText Class="pb-5">@_selectedError</MudText>
        <MudText Typo="Typo.button" Inline="false">Payload</MudText>
        <MudText>@_selectedPayload</MudText>
    </DialogContent>
</MudDialog>